<?php

/**
* 
*/
class clsScan
{
	
	function __construct($db) {
		$this->dbEngine = $db;
		
	}

	function ScanNow($hash, $param, $delim) {
		$dbEng = fopen($this->dbEngine, "r");
		while(!feof($dbEng)) {
			$baca[] = strtolower(fgets($dbEng));
		}
			fclose($dbEng);
			$VirName = NULL;

		foreach ($baca as $baris) {
			# cocokin...
			$cocok = explode($param, $baris);
  			if(strpos($baris, $hash) !== false) {
    			$VirName = $cocok[$delim];
				break;
  			}
		}
		if($VirName != NULL) {
			return $VirName;
		} else {
			return "No Detected";
		}
	}


}
/**
* 
*/
class clsGET 
{
	
	function __construct() {
		$this->konek 	= new mysqli('localhost', 'root', '', 'IDMscan');
	}
	public function GetinDB($selek) {
		$sql 	= 	$this->konek->query('SELECT * from data ORDER by ID ASC');
		while ($rw 		= 	$sql->fetch_array()) {
			$data[] 	= 	$rw[$selek];
		}
			return $data;
	}
	public function GetEngine() {
		$get = clsGET::GetinDB('ENGINE');
		return $get;
	}
	public function GetDbEngine() {
		$get = clsGET::GetinDB('FILE');
		return $get;
	}
	public function GetParams() {
		$get = clsGET::GetinDB('PARAMS');
		return $get;
	}
	public function GetDelim() {
		$get = clsGET::GetinDB('DELIM');
		return $get;
	}
	public function GetDBUpdate() {
		$get = clsGET::GetinDB('PERBARUI');
		return $get;
	}
}

?>